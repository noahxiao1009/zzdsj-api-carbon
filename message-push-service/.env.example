# Message Push Service Environment Configuration

# ========== 基础配置 ==========
ENVIRONMENT=development
SERVICE_NAME=message-push-service  
SERVICE_PORT=8089
DEBUG=true
LOG_LEVEL=INFO

# ========== Redis配置 ==========
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=2
REDIS_URL=redis://localhost:6379/2

# Redis Streams配置
REDIS_STREAM_NAME=sse_messages
REDIS_PUBSUB_CHANNEL=sse_broadcast
REDIS_CONSUMER_GROUP=sse_consumers
REDIS_MAX_STREAM_LENGTH=10000

# ========== SSE配置 ==========
# 连接管理
MAX_CONNECTIONS=10000
HEARTBEAT_INTERVAL=30
MAX_QUEUE_SIZE=1000
CONNECTION_TIMEOUT=300

# 消息配置
DEFAULT_MESSAGE_TTL=3600
MAX_MESSAGE_SIZE=65536
ENABLE_MESSAGE_PERSISTENCE=true

# ========== 安全配置 ==========
# CORS配置
CORS_ORIGINS=["http://localhost:3000","http://localhost:5173","http://localhost:8080"]
CORS_METHODS=["GET","POST","PUT","DELETE","OPTIONS"]
ENABLE_CORS=true

# 认证配置（可选）
ENABLE_AUTH=false
JWT_SECRET=your-jwt-secret-key
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=1440

# API密钥认证（可选）
ENABLE_API_KEY_AUTH=false
API_KEYS=["your-api-key-1","your-api-key-2"]

# ========== 网关集成 ==========
# 网关注册
GATEWAY_URL=http://localhost:8080
ENABLE_GATEWAY_REGISTRATION=true
SERVICE_DISCOVERY_INTERVAL=60

# 健康检查
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=5

# ========== 性能配置 ==========
# 连接池
MIN_CONNECTIONS=10
MAX_CONNECTIONS_PER_USER=50
CONNECTION_POOL_SIZE=100

# 消息处理
BATCH_SIZE=100
PROCESSING_TIMEOUT=30
RETRY_ATTEMPTS=3
RETRY_DELAY=1

# 内存管理
MAX_MEMORY_USAGE=512MB
GARBAGE_COLLECTION_INTERVAL=300

# ========== 监控配置 ==========
# Prometheus metrics
ENABLE_METRICS=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# 日志配置
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=message_push_service.log
LOG_ROTATION=daily
LOG_RETENTION_DAYS=7

# 统计配置
ENABLE_STATS_COLLECTION=true
STATS_AGGREGATION_INTERVAL=60
STATS_RETENTION_HOURS=24

# ========== 集群配置 ==========
# 多实例支持
ENABLE_CLUSTERING=false
CLUSTER_NODE_ID=node-1
CLUSTER_NODES=["node-1","node-2","node-3"]

# 负载均衡
LOAD_BALANCER_STRATEGY=round_robin
STICKY_SESSIONS=false

# ========== 开发配置 ==========
# 热重载
ENABLE_RELOAD=true
RELOAD_DIRS=["app"]
RELOAD_EXCLUDES=["*.log","*.tmp","__pycache__"]

# 调试
ENABLE_DEBUG_ENDPOINTS=true
DEBUG_LOG_MESSAGES=false
ENABLE_REQUEST_LOGGING=true