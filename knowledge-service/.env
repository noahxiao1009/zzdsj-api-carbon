# 智政科技AI智能办公助手 - 知识库服务环境配置
# 使用实际的数据库和模型服务配置

# ========== 基础配置 ==========
ENVIRONMENT=local
LOG_LEVEL=INFO
SERVICE_PORT=8082
DEBUG=true

# ========== 数据库配置 ==========
# PostgreSQL配置
POSTGRES_HOST=localhost
POSTGRES_PORT=5434
POSTGRES_USER=zzdsj_demo
POSTGRES_PASSWORD=zzdsj123
POSTGRES_DB=zzdsj_demo
POSTGRES_SCHEMA=public

# 完整数据库URL
DATABASE_URL=postgresql://zzdsj_demo:zzdsj123@localhost:5434/zzdsj_demo

# Redis配置 
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_URL=redis://localhost:6379/0

# ========== 向量存储配置 ==========
# 主要使用Milvus
VECTOR_DB_TYPE=milvus
MILVUS_HOST=localhost
MILVUS_PORT=19530
MILVUS_USER=
MILVUS_PASSWORD=

# PGVector配置（备选）
PGVECTOR_ENABLED=true
PGVECTOR_TABLE_NAME=vector_embeddings
PGVECTOR_DIMENSION=8192

# Elasticsearch配置
ELASTICSEARCH_ENABLED=true
ELASTICSEARCH_HOSTS=http://localhost:9200
# ELASTICSEARCH_USERNAME=elastic
# ELASTICSEARCH_PASSWORD=nLNNrfAsg4HV+haCd7xA
ELASTICSEARCH_HOST=localhost
ELASTICSEARCH_PORT=9200

# ========== 硅基流动模型配置 ==========
# 基础API配置
SILICONFLOW_API_BASE=https://api.siliconflow.cn/v1
SILICONFLOW_API_KEY=sk-mnennlifdngjififromhljflqsblutyfgfvwerkfhsxummcn

# OpenAI兼容配置（用于LlamaIndex集成）
OPENAI_API_KEY=sk-mnennlifdngjififromhljflqsblutyfgfvwerkfhsxummcn
OPENAI_BASE_URL=https://api.siliconflow.cn/v1

# 嵌入模型配置
DEFAULT_EMBEDDING_PROVIDER=openai
DEFAULT_EMBEDDING_MODEL=Qwen/Qwen3-Embedding-8B
DEFAULT_EMBEDDING_DIMENSION=8192
OPENAI_API_BASE=https://api.siliconflow.cn/v1

# Azure OpenAI配置（备用）
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_API_VERSION=2023-12-01-preview

# 重排序模型配置
RERANK_MODEL=Qwen/Qwen3-Reranker-8B
RERANK_API_BASE=https://api.siliconflow.cn/v1
RERANK_API_KEY=sk-mnennlifdngjififromhljflqsblutyfgfvwerkfhsxummcn

# HuggingFace配置（备用）
HUGGINGFACE_API_KEY=
HUGGINGFACE_MODEL_PATH=

# ========== LlamaIndex配置 ==========
# 文档处理配置
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
MAX_TOKENS=4000

# 检索配置
SIMILARITY_TOP_K=5
SIMILARITY_THRESHOLD=0.7

# 混合搜索配置
ENABLE_HYBRID_SEARCH=true
VECTOR_WEIGHT=0.7
TEXT_WEIGHT=0.3

# 重排序配置
ENABLE_RERANKING=true
RERANK_TOP_K=10

# 缓存配置
ENABLE_CACHING=true
CACHE_TTL=3600

# ========== Agno框架配置 ==========
ENABLE_AGNO_INTEGRATION=true
AGNO_KNOWLEDGE_SEARCH=true
AGNO_ADD_CONTEXT=true
AGNO_MARKDOWN=true
AGNO_SHOW_TOOL_CALLS=true
AGNO_SEARCH_TYPE=hybrid
AGNO_MAX_RESULTS=10
AGNO_CONFIDENCE_THRESHOLD=0.6

# ========== 外部服务配置 ==========
# 模型服务URL（8083端口）
MODEL_SERVICE_URL=http://localhost:8083
MODEL_SERVICE_TIMEOUT=30

# 智能体服务URL（8081端口）
AGENT_SERVICE_URL=http://localhost:8081
AGENT_SERVICE_TIMEOUT=60

# 基础服务URL（8084端口）
BASE_SERVICE_URL=http://localhost:8084
BASE_SERVICE_TIMEOUT=30

# 网关服务URL（8080端口）
GATEWAY_SERVICE_URL=http://localhost:8080

# ========== 文件存储配置 ==========
# MinIO对象存储配置
STORAGE_BACKEND=minio
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=zzdsjadmin
MINIO_SECRET_KEY=zzdsjadmin
MINIO_SECURE=false
MINIO_BUCKET_NAME=knowledge-files

# 本地存储配置（备选）
LOCAL_STORAGE_PATH=./uploads
TEMP_UPLOAD_DIR=/tmp/uploads

# ========== 异步任务队列配置 ==========
# Redis队列配置
ENABLE_ASYNC_PROCESSING=true
DEFAULT_QUEUE_NAME=document_processing
TASK_TIMEOUT=300
MAX_TASK_RETRIES=3
WORKER_CONCURRENCY=3

# 任务处理配置
ENABLE_TASK_NOTIFICATIONS=true
NOTIFICATION_CHANNEL=task_notifications
TASK_RETENTION_DAYS=7

# ========== 文档处理配置 ==========
# 文件上传配置
UPLOAD_DIR=uploads
MAX_FILE_SIZE=104857600  # 100MB
ALLOWED_EXTENSIONS=[".pdf",".txt",".docx",".doc",".md",".csv",".json",".html"]

# 并发配置
MAX_WORKERS=4
BATCH_SIZE=100

# OCR配置
ENABLE_OCR=true
OCR_LANGUAGE=chi_sim+eng
EXTRACT_TABLES=true
EXTRACT_IMAGES=false

# 切分策略配置
DEFAULT_CHUNK_SIZE=1024
DEFAULT_CHUNK_OVERLAP=128
DEFAULT_CHUNK_STRATEGY=basic
ENABLE_SEMANTIC_CHUNKING=true
ENABLE_INTELLIGENT_CHUNKING=true

# ========== CORS配置 ==========
CORS_ORIGINS=["http://localhost:5173","http://localhost:3000","http://localhost:8080","http://127.0.0.1:3000","http://127.0.0.1:8080"]
CORS_METHODS=["GET","POST","PUT","DELETE","OPTIONS"]

# ========== API配置 ==========
API_PREFIX=/api/v1
DOCS_URL=/docs
OPENAPI_URL=/openapi.json

# ========== 性能配置 ==========
REQUEST_TIMEOUT=60
MAX_RETRIES=3
RETRY_DELAY=1
BACKOFF_FACTOR=2

# ========== 调试配置 ==========
TESTING=false
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=knowledge_service.log

# ========== 开发配置 ==========
# 热重载配置 (仅开发环境)
ENABLE_RELOAD=true
RELOAD_DIRS=["app","config"]
RELOAD_EXCLUDES=["*.log","*.tmp","__pycache__","*.pyc"]
